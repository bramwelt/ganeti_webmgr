{% load i18n %}
{% load webmgr_tags %}
<script type="text/javascript" src="{{STATIC_URL}}/js/jquery.tablesorter.min.js"></script>
<script type="text/javascript">
    $(function(){
        $("#nodes .sorted").tablesorter();
    });
</script>
<script type='text/javascript' src="{{STATIC_URL}}/js/jquery.dualmeter.js"></script>
<script type='text/javascript'>
    $(function(){
        var settings = {
            'bgImage': '{{STATIC_URL}}/images/dualmeter/meter_bg.png',
            'progBarImages': {
                0:  ['{{STATIC_URL}}/images/dualmeter/meter_green_dark.png',
                     '{{STATIC_URL}}/images/dualmeter/meter_green.png'],
                30: ['{{STATIC_URL}}/images/dualmeter/meter_yellow_dark.png',
                     '{{STATIC_URL}}/images/dualmeter/meter_yellow.png'],
                50: ['{{STATIC_URL}}/images/dualmeter/meter_orange_dark.png',
                     '{{STATIC_URL}}/images/dualmeter/meter_orange.png'],
                75: ['{{STATIC_URL}}/images/dualmeter/meter_red_dark.png',
                     '{{STATIC_URL}}/images/dualmeter/meter_red.png']
            }
        }
        {% for node in nodes %}
            $("#nodes .ram #ram_meter_{{node.id}}").dualMeter(settings, {% node_memory_values node %});
            $("#nodes .disk #disk_meter_{{node.id}}").dualMeter(settings, {% node_disk_values node %});
        {% endfor %}
    });
</script>

<table id="nodes" class="sorted">
<thead>
    <tr>
        <th class="status"></th>
        <th>{% trans "Name" %}</th>
        <th>{% trans "RAM [MiB]" %}</th>
        <th>{% trans "Disk [MiB]" %}</th>
        <th title="{% trans "CPUs (Allocated/Physical)" %}">{% trans "CPUs (A/P)" %}</th>
        <th title="{% trans "Instances (Primary/Secondary)"%}">{% trans "Instances (P/S)" %}</th>
    </tr>
</thead>
<tbody>
    {% for node in nodes %}
        <tr>
            <td class="status">
            {% if node.info.offline %}
                <div class="icon_stopped" title="Offline"></div>
            {% else %}
                <div class="icon_running" title="Online"></div>
            {% endif %}
            </td>
            <td>
                <a href="{% url node-detail cluster.slug node.hostname %}">
                    {{ node.hostname|abbreviate_fqdn }}
                </a>
            </td>
            <td class="ram" title="Used: {{node.ram.used}} Allocated: {{node.ram.allocated}} Total: {{node.ram.total}}" align='center'>
                <div id='ram_meter_{{node.id}}'></div>
            </td>
            <td class="disk" title="Used: {{node.disk.used}} Allocated: {{node.disk.allocated}} Total: {{node.disk.total}}" align='center'>
                <div id='disk_meter_{{node.id}}'></div>
            </td>
            <td>{{ cpus|index:node.id }} / {{ node.cpus }}</td>
            <td>{{ node.info.pinst_cnt }} / {{ node.info.sinst_cnt }}</td>
        </tr>
    {% endfor %}
</tbody>
</table>
<br />
<div style='float: left'>Used&nbsp;</div>
    <div style='float: left' title='0% to <30%'><img src='{{STATIC_URL}}/images/dualmeter/meter_green_dark.png'/></div>
    <div style='float: left' title='30% to <50%'><img src='{{STATIC_URL}}/images/dualmeter/meter_yellow_dark.png'/></div>
    <div style='float: left' title='50% to <75%'><img src='{{STATIC_URL}}/images/dualmeter/meter_orange_dark.png'/></div>
    <div style='float: left' title='75% to 100%'><img src='{{STATIC_URL}}/images/dualmeter/meter_red_dark.png'/></div>
    <div style='float: left'>&nbsp;&nbsp;&nbsp;</div>
<div style='float: left'>Allocated&nbsp;</div>
    <div style='float: left' title='0% to <30%'><img src='{{STATIC_URL}}/images/dualmeter/meter_green.png'/></div>
    <div style='float: left' title='30% to <50%'><img src='{{STATIC_URL}}/images/dualmeter/meter_yellow.png'/></div>
    <div style='float: left' title='50% to <75%'><img src='{{STATIC_URL}}/images/dualmeter/meter_orange.png'/></div>
    <div title='75% to 100%'><img src='{{STATIC_URL}}/images/dualmeter/meter_red.png'/></div>
